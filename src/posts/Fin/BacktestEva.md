---
title: BacktestEva
icon: file
order: 6
author: Doris
category:
  - Fin
tags:
  - Fin
footer: What is the meaning of data?
copyright: 无版权
date: 2024-11
---
# 0 Intro

https://zhuanlan.zhihu.com/p/441872141

# 1 Backtesting architecture - backtesing.py

documentation: https://kernc.github.io/backtesting.py/doc/backtesting/backtesting.html#gsc.tab=0

# 2 Evaluation of Backtest

1. exposure time [%]: The percentage of time that the strategy is in the market with an active position.
2. Equity Final
3. Equity Peak
4. Return [%]:The total percentage return generated by the strategy during the evaluation period. "The strategy grew the initial quity by x%."

$$
%\text{Return} = \frac{\text{Final Equity} - \text{Initial Equity}}{\text{Initial Equity}} \times 100%
$$

5. Buy & Hold Return [%]: The return you would have earned by simply buying and holding the underlying asset throughout the evaluation period.
6. Return (Ann.) [%]: The annualized return
7. Volatility (Ann.) [%]: The annualized volatility of returns, representing the riskiness of the strategy.

$$
\text{Volatility} = \sqrt{252} \times \sigma_{\text{daily returns}}
$$

8. Sharpe Ratio: A risk-adjusted performance metric that indicates **how much excess return you earn for the extra risk taken**, compared to a risk-free investment.

- A high Sharpe Ratio suggests that the investment offers good returns for the amount of risk taken. It is a preferred metric for comparing the performance of different investments.
- High SR investments are typically favored for constructing efficient portfolios.

$$
\text{Sharpe Ratio} = \frac{R_p - R_f}{\sigma_p}
$$

$$
R_p \text{: portfolio return}
$$

$$
R_f \text{: risk-free rate}
$$

$$
\sigma_p \text{: volatility of the portfolio (standard deviation of returns)}
$$

10. Sortino Ratio:Similar to the Sharpe Ratio but only considers downside risk (negative volatility).

$$
\text{Sortino Ratio} = \frac{R_p - R_f}{\sigma_{\text{downside}}}
$$

$$
\sigma_\text{downside} \text{: standard deviation of only negative returns}
$$

10. Calmar Ratio: Compares the annualized return with the maximum drawdown.

$$
\text{Calmar Ratio} = \frac{R_{\text{ann}}}{\text{Max Drawdown}}
$$

11. Max. Drawdown [%]: The largest percentage drop from the peak equity value to a subsequent low during the evaluation period.
    A high MDD signals higher risk, indicating that the investment has experienced significant drawdowns. This can be a red flag for risk-averse investors.
    Worst-case senarios.

$$
\text{Max Drawdown} = \frac{\text{Peak Equity} - \text{Trough Equity}}{\text{Peak Equity}} \times 100%
$$

12. Avg. Drawdown [%]: The average percentage drop from the peaks to the troughs during the evaluation period.

$$
\text{Avg. Drawdown} = \frac{\sum_{i=1}^{n} \text{Drawdown}_i}{n}
$$

$$
n \text{: \#drawdowns}
$$

13. Max. Drawdown Duration: The maximum time in days that the portfolio took to recover from a drawdown.
14. Avg. Drawdown Duration: The average duration (in days) the portfolio was in a drawdown state.
15. \# Trades: The total number of trades made by the strategy during the evaluation period
16. Win Rate [%]: The percentage of trades that were **profitable**. A win rate of 64.86% means that about 65% of the trades made money.
17. Best Trade [%]: The largest percentage **gain** on a single trade.
18. Worst Trade [%]: The largest percentage loss on a single trade.
19. Avg. Trade [%]: The average percentage return per trade.
20. Max. Trade Duration: The **longest time a single trade** was held (in days).
21. Avg. Trade Duration: The average number of days that trades were held.
22. Profit Factor: The ratio of gross profits (毛利) to gross losses (总损失). A value of 5.51 means the strategy's gross profits were 5.51 times higher than its gross losses.
23. Expectancy [%]: The expected return per trade. Here, the strategy has an expectancy of 2.79%, meaning that on average, each trade is expected to return 2.79%.

$$
\text{Expectancy} = \left( P_w \times A_w \right) - \left( P_l \times A_l \right)
$$

$$
P_w \text{: probability of a win}
$$

$$
A_w \text{: average win}
$$

$$
P_l \text{: probability of a loss}
$$

$$
A_l \text{: average loss}
$$

24. SQN (System Quality Number):evaluates the strategy based on both its risk and reward. A value of 2.9 indicates a fairly good trading system (a value above 2 is generally considered good).

$$
\text{SQN} = \frac{\bar{R}}{\sigma_R} \times \sqrt{n}
$$

$$
\bar{R}\text{: average trade return}
$$

$$
\sigma_R\text{: std of trade return}
$$

$$
n: \#trades
$$

## References

[1] CodeTrading. YouTube. Automated Support and Resistance Detection in PYTHON. https://www.youtube.com/watch?v=aJ8Og-iLaas&list=PLwEOixRFAUxZmM26EYI1uYtJG39HDW1zm&index=71
